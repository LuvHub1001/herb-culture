import{j as e,r as c,R as D,g as z,I,l as V,b as M,a as y,c as F}from"./index-h19CEXed.js";function K(){return e.jsxs("div",{className:"flex w-screen mt-10 justify-center items-center",children:[e.jsx("input",{type:"text",className:"border-2 rounded-lg w-120 h-15 placeholder:text-lg p-2",placeholder:"원하시는 문화행사를 검색하세요"}),e.jsx("img",{src:"/assets/images/search.svg",className:"absolute right-178 cursor-pointer"})]})}const O={},H=c.createContext(void 0);function L(t){return c.useContext(H)||z()}const R=t=>typeof(t==null?void 0:t.then)=="function",U=t=>{t.status="pending",t.then(l=>{t.status="fulfilled",t.value=l},l=>{t.status="rejected",t.reason=l})},q=D.use||(t=>{if(t.status==="pending")throw t;if(t.status==="fulfilled")return t.value;throw t.status==="rejected"?t.reason:(U(t),t)}),_=new WeakMap,W=(t,l)=>{let s=_.get(t);return s||(s=new Promise((o,n)=>{let u=t;const r=a=>h=>{u===a&&o(h)},i=a=>h=>{u===a&&n(h)},d=()=>{try{const a=l();R(a)?(_.set(a,s),u=a,a.then(r(a),i(a)),I(a,d)):o(a)}catch(a){n(a)}};t.then(r(t),i(t)),I(t,d)}),_.set(t,s)),s};function J(t,l){const s=L(),[[o,n,u],r]=c.useReducer(a=>{const h=s.get(t);return Object.is(a[0],h)&&a[1]===s&&a[2]===t?a:[h,s,t]},void 0,()=>[s.get(t),s,t]);let i=o;if((n!==s||u!==t)&&(r(),i=s.get(t)),c.useEffect(()=>{const a=s.sub(t,()=>{r()});return r(),a},[s,t,void 0]),c.useDebugValue(i),R(i)){const a=W(i,()=>s.get(t));return q(a)}return i}function Q(t,l){const s=L();return c.useCallback((...n)=>{if((O?"production":void 0)!=="production"&&!("write"in t))throw new Error("not writable atom");return s.set(t,...n)},[s,t])}function p(t,l){return[J(t),Q(t)]}const X=()=>{const[t,l]=c.useState(null);return{catchAsyncError:o=>{l(()=>{throw o})}}},T=(t,l,s)=>{const{catchAsyncError:o}=X(),[n,u]=c.useState(),[r,i]=c.useState("pending"),[d,a]=c.useState(null),h=c.useCallback(g=>{i("fulfilled"),a(g)},[]);if(c.useEffect(()=>{i("pending"),u(t(l,s).then(h).catch(g=>o(g)))},[l]),n&&r==="pending")throw n;return d},$=({totalItems:t,divider:l})=>{const[s,o]=c.useState(1),[n,u]=c.useState(1);c.useEffect(()=>{u(Math.ceil(t/l))},[t,l]);const r=c.useMemo(()=>s===1,[s]),i=c.useMemo(()=>s>=n,[s,n]),d=5,a=Math.floor((s-1)/d)*d+1,h=Math.min(a+d-1,n),g=Array.from({length:h-a+1},(m,N)=>a+N);return{currentPage:s,totalPage:n,isFirstPage:r,isLastPage:i,pageNumbers:g,setCurrentPage:o,handlePrevButton:()=>{o(m=>m>1?m-1:m)},handleNextButton:()=>{o(m=>m<n?m+1:m)},handleFirstButton:()=>{o(1)},handleLastButton:()=>{o(n)}}},Y=()=>{const[t,l]=p(V),[s,o]=p(M),n=u=>{o(u)};return c.useEffect(()=>{const{geolocation:u}=navigator;u&&u.getCurrentPosition(r=>{const{latitude:i,longitude:d}=r.coords;l({latitude:i,longitude:d})},r=>console.log(r),{enableHighAccuracy:!0,maximumAge:0,timeout:5e3})},[]),{location:t,buttonGu:s,handleButtonGu:n,setButtonGu:o}},Z=[{id:0,name:"강남구"},{id:1,name:"강동구"},{id:2,name:"강북구"},{id:3,name:"강서구"},{id:4,name:"관악구"},{id:5,name:"광진구"},{id:6,name:"구로구"},{id:7,name:"금천구"},{id:8,name:"노원구"},{id:9,name:"도봉구"},{id:10,name:"동대문구"},{id:11,name:"동작구"},{id:12,name:"마포구"},{id:13,name:"서대문구"},{id:14,name:"서초구"},{id:15,name:"성동구"},{id:16,name:"성북구"},{id:17,name:"송파구"},{id:18,name:"양천구"},{id:19,name:"영등포구"},{id:20,name:"용산구"},{id:21,name:"은평구"},{id:22,name:"종로구"},{id:23,name:"중구"},{id:24,name:"중랑구"}];function tt(){const{location:t,buttonGu:l,handleButtonGu:s,setButtonGu:o}=Y(),[n,u]=p(F),r=T(y,`https://dapi.kakao.com/v2/local/geo/coord2address.json?x=${t==null?void 0:t.longitude}&y=${t==null?void 0:t.latitude}`,{headers:{Authorization:"KakaoAK 834047dfaffa59c1f05747402691e1aa"}});return c.useEffect(()=>{var i;if((i=r==null?void 0:r.data)!=null&&i.documents&&r.data.documents[0]){const d=r.data.documents[0].address.region_2depth_name;u(d),o(d)}},[r==null?void 0:r.data]),c.useEffect(()=>{n&&o(n)},[n]),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex justify-center mt-5",children:e.jsxs("div",{children:["현재 접속 위치는"," ",e.jsx("span",{className:"text-blue-500",children:n||"알 수 없음"}),"입니다."]})}),e.jsx("div",{className:"flex mt-5 justify-center",children:e.jsx("div",{className:"grid grid-cols-10 gap-3",children:Z.map(i=>e.jsx("div",{children:e.jsx("button",{className:`cursor-pointer rounded-2xl w-20 text-white ${l===i.name?"bg-blue-500":"bg-gray-400"}`,onClick:()=>s(i.name),children:i.name})},i.id))})})]})}function et({totalItems:t,divider:l,onPageChange:s}){const{currentPage:o,isFirstPage:n,isLastPage:u,pageNumbers:r,handlePrevButton:i,handleNextButton:d,handleFirstButton:a,handleLastButton:h,setCurrentPage:g}=$({totalItems:t,divider:l});return c.useEffect(()=>{s(o)},[o,s]),e.jsxs("div",{className:"flex mt-20 w-screen h-7 justify-center items-center gap-3",children:[e.jsx("img",{src:"/assets/images/arrow_back2.svg",className:`cursor-pointer ${n?"opacity-50 cursor-not-allowed":""}`,onClick:n?void 0:a}),e.jsx("img",{src:"/assets/images/arrow_back1.svg",className:`cursor-pointer ${n?"opacity-50 cursor-not-allowed":""}`,onClick:n?void 0:i}),e.jsx("div",{className:"flex gap-2",children:r.map(x=>e.jsx("button",{className:`border-2 rounded-4xl w-8 h-8 cursor-pointer text-center ${o===x?"bg-blue-500 text-white":"bg-white text-black"}`,onClick:()=>g(x),children:x},x))}),e.jsx("img",{src:"/assets/images/arrow_front1.svg",className:`cursor-pointer ${u?"opacity-50 cursor-not-allowed":""}`,onClick:u?void 0:d}),e.jsx("img",{src:"/assets/images/arrow_front2.svg",className:`cursor-pointer ${u?"opacity-50 cursor-not-allowed":""}`,onClick:u?void 0:h})]})}function st(){var N,k;const[t,l]=c.useState(0),{currentPage:s,setCurrentPage:o}=$({totalItems:t,divider:10}),[n]=p(M),[u]=p(F),[r,i]=c.useState([]),[d,a]=c.useState([]),[h,g]=c.useState(!0),x=(s-1)*10+1,S=s*10,w=T(y,"/culturalEventInfo/1/1"),E=(k=(N=w==null?void 0:w.data)==null?void 0:N.culturalEventInfo)==null?void 0:k.list_total_count;c.useEffect(()=>{E&&(async()=>{if(E){const A=Math.ceil(E/1e3),B=[];for(let j=0;j<A;j++){const P=j*1e3+1,b=Math.min((j+1)*1e3,E);B.push(y(`/culturalEventInfo/${P}/${b}`))}try{const P=(await Promise.all(B)).map(b=>{var C,G;return((G=(C=b==null?void 0:b.data)==null?void 0:C.culturalEventInfo)==null?void 0:G.row)||[]}).flat();i(P),g(!1)}catch(j){console.error(j),g(!1)}}})()},[E]),c.useEffect(()=>{if(r.length>0){const f=n||u,v=r.filter(A=>A.GUNAME===f);a(v),l(v.length)}},[r,n,u]);const m=d.slice(x-1,S);return c.useEffect(()=>{o(1)},[n]),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex w-screen justify-center mt-10",children:e.jsx("div",{className:"grid w-10/12 grid-cols-5 gap-6",children:h?[...Array(10)].map((f,v)=>e.jsx(nt,{},v)):m.map((f,v)=>e.jsxs("div",{className:"border-2 border-[#EFEFEF] rounded-2xl",children:[e.jsx("a",{className:"cursor-pointer",href:f.ORG_LINK,target:"_blank",children:e.jsx("img",{className:"w-full h-70 rounded-tl-xl rounded-tr-xl",src:f.MAIN_IMG})}),e.jsxs("div",{className:"p-2",children:[e.jsx("div",{children:f.TITLE.length>18?f.TITLE.slice(0,18)+"...":f.TITLE}),e.jsxs("div",{children:["구분: ",f.CODENAME]}),e.jsxs("div",{children:["지역: ",f.GUNAME]}),e.jsxs("div",{children:["기간: ",f.DATE]})]})]},v))})}),e.jsx(et,{totalItems:t,divider:10,onPageChange:o},n)]})}function nt(){return e.jsx("div",{className:"flex w-75 h-99 bg-gray-400 rounded-2xl animate-pulse",children:e.jsx("div",{className:"w-[310px] m-3 rounded-2xl",children:e.jsxs("div",{children:[e.jsx("div",{className:" bg-gray-300 rounded-tl-xl rounded-tr-xl",children:e.jsx("div",{className:"h-[260px]"})}),e.jsx("div",{className:"h-[100px] mt-[10px]  bg-gray-300"})]})})})}function rt(){return e.jsxs(e.Fragment,{children:[e.jsx(K,{}),e.jsx(tt,{}),e.jsx(st,{})]})}export{rt as default};
